# Migration `20200829125222-add-custom-asset`

This migration has been generated by Amin Mushehid at 8/29/2020, 2:52:22 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."CustomAsset" (
"id" integer  NOT NULL )

CREATE TABLE "public"."HistoricalValue" (
"id" SERIAL,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"date" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"unitPrice" integer  NOT NULL ,
"assetId" integer  NOT NULL ,
PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "CustomAsset.id_unique" ON "public"."CustomAsset"("id")

ALTER TABLE "public"."CustomAsset" ADD FOREIGN KEY ("id")REFERENCES "public"."Asset"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."HistoricalValue" ADD FOREIGN KEY ("assetId")REFERENCES "public"."CustomAsset"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200828175434-add-transaction-type..20200829125222-add-custom-asset
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator prisma_client {
   provider = "prisma-client-js"
@@ -24,36 +24,53 @@
   name        String
   ticker      String?
   description String?
   quantity    Int           @default(0)
-  Portfolio   Portfolio    @relation(fields: [portfolioId], references: [id])
+  Portfolio   Portfolio     @relation(fields: [portfolioId], references: [id])
   portfolioId Int
   Transaction Transaction[]
+  CustomAsset CustomAsset
 }
+model CustomAsset {
+  id              Int               @unique
+  asset           Asset             @relation(fields: [id], references: [id])
+  HistoricalValue HistoricalValue[]
+}
+
+model HistoricalValue {
+  id        Int         @id @default(autoincrement())
+  updatedAt DateTime    @updatedAt @default(now())
+  createdAt DateTime    @default(now())
+  date      DateTime    @default(now())
+  unitPrice Int
+  asset     CustomAsset @relation(fields: [assetId], references: [id])
+  assetId   Int
+}
+
 model Portfolio {
   id          Int      @id @default(autoincrement())
   updatedAt   DateTime @updatedAt @default(now())
   createdAt   DateTime @default(now())
   name        String
   description String?
   assets      Asset[]
-  User        User    @relation(fields: [userId], references: [id])
+  User        User     @relation(fields: [userId], references: [id])
   userId      Int
 }
 model Transaction {
-  id            Int      @id @default(autoincrement())
-  updatedAt     DateTime @updatedAt @default(now())
-  createdAt     DateTime @default(now())
-  date          DateTime @default(now())
-  note          String?
-  currency      String
-  unitPrice     Int
-  totalPrice    Int
-  assetQuantity Int
-  asset         Asset    @relation(fields: [assetId], references: [id])
-  assetId       Int
+  id              Int             @id @default(autoincrement())
+  updatedAt       DateTime        @updatedAt @default(now())
+  createdAt       DateTime        @default(now())
+  date            DateTime        @default(now())
+  note            String?
+  currency        String
+  unitPrice       Int
+  totalPrice      Int
+  assetQuantity   Int
+  asset           Asset           @relation(fields: [assetId], references: [id])
+  assetId         Int
   TransactionType TransactionType
 }
 enum TransactionType {
```


